---

- name: Install and Upload my Web Page
  hosts: all
  become: yes

  vars:
    source_folder: ./MyWebSite2
    destin_folder: /var/www/html


  tasks:

  - name: Check and print OS family
    debug: var=ansible_os_family


  - block:   #======= Block for RedHat=======

      - name: Install Apache Web Server for Redhat
        yum: name=httpd state=latest

      - name: Start WebServer for RedHat
        service: name=httpd state=started enabled=yes

    when: ansible_os_family == "RedHat"

  - block:  #========= Block for Debian========

      - name: Install Apache Web Servr for Debian
        apt: name=apache2 state=latest

      - name: Start WebServer for Debian
        service: name=apache2 state=started enabled=yes

    when: ansible_os_family == "Debian"



  - name: Copy MyHomePage to Servers
    copy: src={{ item }} dest={{ destin_folder }} mode=0555
    with_fileglob: "{{ source_folder }}/*.*"


#    loop: 
#       - "index.html"
#       - "facial1.jpg"
#       - "facial2.jpg"
#       - "facial3.jpg"
#       - "logo.jpg"
#       - "home.jpg"
    notify:
    - Restart Apache RedHat
    - Restart Apache Debian

  handlers:
  - name: Restart Apache RedHat
    service: name=httpd state=restarted
    when: ansible_os_family == "RedHat"

  - name: Restart Apache Debian
    service: name=apache2 state=restarted 
    when: ansible_os_family == "Debian"
